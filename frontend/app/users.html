<!DOCTYPE html>
<html>
	<head>
		<meta http-equiv="content-type" content="text/html; charset=utf-8" />
		<title>Manage Users</title>
		<link rel="stylesheet" href="../css/bootstrap.css" type="text/css" charset="utf-8"/>
		<link rel="stylesheet" href="../css/app.css" type="text/css" charset="utf-8"/>
		<script src="/shared/jquery.min.js" type="text/javascript" charset="utf-8"></script>
		<script src="/shared/utils.js" type="text/javascript" charset="utf-8"></script>
		<script src="../js/jquery.watch.min.js" type="text/javascript" charset="utf-8"></script>
		<script src="../js/bootstrap.min.js" type="text/javascript" charset="utf-8"></script>
		<script src="../js/app.js" type="text/javascript" charset="utf-8"></script>
		<script src="../js/app/users.js" type="text/javascript" charset="utf-8"></script>
	</head>
	<body>
		<div id="header">
			<h1><span i18n>extName</span> <small><span i18n>title</span></small></h1>
		</div>
		<div class="container">
			<div class="row">
				<div class="span3">
					<ul id="navbar" class="nav nav-list">
					</ul>
				</div>	
				<div id="app-content" class="span9">
					<div class="content">
						<div class="page-header">
							<h3>Manage users <small>Currently mapped users</small></h3>
						</div>	
						<div id="user_list">
						</div>
						<div id="user_refresh">
							<p class="light">
							BroadMask tries to automatically associate PGP key identifiers to their users using Facebook notes.<br/>
							You are advised to <strong>ensure</strong> the correctness of the key mappings before using them.</p>

							<p class="light">
							If you think a mapping should have been found, you can check for new key entries using the following button 
							</p>

							<p>
							<a id="user_mapping_refresh" data-loading-text="Refreshing" class="btn btn-primary"><i class="icon-white icon-refresh"></i> Update manually</a>
							</p>
						</div>
						<div class="page-header">
							<h3>Create mapping <small>Create mapping of friends to PGP keys</small></h3>
						</div>	
						<div style="display:none" id="create_user_success" class="alert alert-success">
							The user mapping has been created.
						</div>
						<form id="create_user_map" class="form form-horizontal">
							<div class="control-group">
								<label class="control-label"  for="friend_name">Friend name</label>
								<div class="controls">
									<input type="text" autocomplete="off" class="input-xlarge" id="friend_name">
									<p class="help-block light">Enter the name or id of your friend you want to enter a PGP-Key for</p>
								</div>
							</div>
							<div class="control-group">
								<label class="control-label" for="key_id">PGP-Key Identifier</label>
								<div class="controls">
									<input type="text" class="input-xlarge" id="key_id">
									<p class="help-block light">Enter the <strong>PGP Public-Key</strong> identifier or fingerprint you want to associate with this user. <br/>Note: A corresponding key must be found in your GPG keychain.</p>
								</div>
							</div>
							<div class="control-group">
								<label class="control-label" for="key_block">PGP Public-Key Block</label>
								<div class="controls">
									<textarea class="span6" id="key_block" rows="15"></textarea>
									<p class="help-block light">Alternatively, paste the PGP Public-Key Block you want to associate with this user. The embedded key will be imported to your keychain.</p>
								</div>
							</div>
							<div class="form-actions">
								<button id="btn-create-mapping" type="submit" class="btn btn-success">Create mapping</button>
								<button class="btn">Reset</button>
							</div>
						</form>
					</div>
					<div id="gpgkey">
						<div class="page-header">
							<h3>PGP-Key <small>Upload your PGP fingerprint to Facebook</small></h3>
						</div>
						<p>
						In order to exchange keys directly through Facebook in an automated fashion, you need to publish your PGP key identifier in your profile. To create a PGP keypair, use the GnuPG keychain or the <em>gpg</em> console program.
						</p>
						<form id="pgp-form" class="form form-horizontal">
							<fieldset>
								<div class="control-group">
									<label class="control-label" for="key-info">Currently published id</label>
									<div class="controls">
										<input class="span3" id="key-info" size="24" readonly="readonly" value="Loading" type="text"><button id="btn_lookup_key" class="btn btn-small" type="button" disabled>Show on Facebook</button>
										<p class="help-block light">
										This is the currently published key identifier
										</p>
									</div>
								</div>
								<div class="control-group">
									<label class="control-label" for="key-select">Your PGP-Key</label>
									<div class="controls">
										<select class="span5" id="key-select" disabled>
										</select>
										<p class="help-block light">
										Select one of your private keys to share on Facebook.
										</p>
									</div>
								</div>
								<div class="form-actions">
									<button id="upload-key-btn" class="btn btn-success" disabled><i class="icon-white icon-arrow-up"></i> Share on Facebook</button>
									<button id="remove-key-btn"class="btn btn-inverse" disabled>Delete current id</button>
								</div>
							</fieldset>
						</form>
					</div>
				</div>
			</div>
		</body>
		<script src="../js/i18n.js" type="text/javascript" charset="utf-8"></script>
		<script type="text/javascript" charset="utf-8">
			UI.bmMenu("navbar", "users");	
		</script>
	</html>
