<!DOCTYPE html>
<html>

	<head>
		<meta charset="utf8">
		<title>Broadmask</title>
		<link rel="stylesheet" href="css/bootstrap.css" type="text/css" charset="utf-8"/>
		<link rel="stylesheet" href="css/popup.css" type="text/css" charset="utf-8"/>
		<script src="js/jquery.min.js" type="text/javascript" charset="utf-8"></script>
		<script type="text/javascript" charset="utf-8">
			$(document).ready(function() {
				var bg = chrome.extension.getBackgroundPage();
				if (typeof bg.unread === 'object') {
					var unread = bg.unread;
					$.each(unread, function (key, val) {
						$("#new").append('<div><img src="' + val + '"/><p>Original image:<br/>' + key + '</p></div>');
					});
					bg.setRead();
				}
			});
		</script>
	</head>

	<body>
		<div id="topbar">
			<span class="title"><span i18n>extName</span></span>
			<nav>
				<a id="options" class="toolbarbtn" target="_blank" href="options.html"/></a>
			</nav>
		</div>
		<div id="new"></div>
		<div style="clear:both"></div>
	</body>
	<script type="text/javascript">

			// Replace span tags with localized message
			$(document).find('*[i18n]').each(function (){
				var msg;
				var tag = $(this);
				// Replace span tag with its content
				if (tag.is('span')) {
					msg = this.innerHTML;
					tag.replaceWith(chrome.i18n.getMessage(msg));
				} else if (tag.is('input') && tag.attr('type') === 'button') {
					// Replace button value with localized message
					msg = tag.attr("value");
					tag.attr('value', chrome.i18n.getMessage(msg));
				}
				// TODO remove debug
				if (chrome.i18n.getMessage(msg) === "") {
					debug("MISSING i18n key " + msg);
				}
			});
		</script>
</html>
